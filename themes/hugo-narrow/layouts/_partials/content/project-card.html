{{/* 项目卡片组件 - 垂直布局（上图下文）
  @context {page} .page 项目页面对象
*/}}

{{ $page := .page }}

{{/* 使用通用图片处理器 */}}
{{- if $page.Params.cover -}}
  {{- partial "content/image-processor.html" (dict
    "context" $page
    "src" $page.Params.cover
    "enablePlaceholder" true
    "outputType" "data"
  ) -}}
{{- else -}}
  {{/* 没有封面图时，仍需要生成占位图数据 */}}
  {{- partial "content/image-processor.html" (dict
    "context" $page
    "src" ""
    "enablePlaceholder" true
    "outputType" "data"
  ) -}}
{{- end -}}

{{- $coverImage := $page.Scratch.Get "imageUrl" -}}
{{- $placeholderData := $page.Scratch.Get "placeholderData" | default dict -}}
{{- $randomImage := $placeholderData.randomImage | default "" -}}
{{- $useRandomImage := $placeholderData.useRandomImage | default false -}}
{{- $gradients := $placeholderData.gradients | default (slice "from-blue-500/20 to-purple-500/10") -}}
{{- $colorIndex := $placeholderData.colorIndex | default 0 -}}

{{- $summaryContent := "" -}}
{{- if $page.Params.summary -}}
  {{- $summaryContent = $page.Params.summary -}}
{{- else if $page.Params.description -}}
  {{- $summaryContent = $page.Params.description -}}
{{- else if $page.Summary -}}
  {{- $summaryContent = $page.Summary | plainify | truncate 120 -}}
{{- end -}}

{{/* 项目卡片 - 垂直布局 */}}
<article class="group">
  <a href="{{ $page.RelPermalink }}" class="block">
    <div class="bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 relative flex flex-col overflow-hidden rounded-xl border p-4 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">

      <!-- 项目封面图片  -->
      <div class="relative h-32 w-full overflow-hidden rounded-lg mb-3">
        {{- if $coverImage -}}
          <img
            src="{{ $coverImage }}"
            alt="{{ $page.Title }}"
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
            loading="lazy"
          />
        {{- else if $useRandomImage -}}
          <img
            src="{{ $randomImage }}"
            alt="{{ $page.Title }}"
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
            loading="lazy"
          />
        {{- else -}}
          {{/* 渐变占位背景 */}}
          <div class="h-full w-full bg-gradient-to-br {{ index $gradients $colorIndex }} flex items-center justify-center">
            <div class="text-muted-foreground/30 text-4xl font-bold">
              {{ substr $page.Title 0 1 | upper }}
            </div>
          </div>
        {{- end -}}

        <!-- Featured 标签 -->
        {{ if $page.Params.featured }}
          <div class="absolute top-2 right-2 bg-primary text-primary-foreground px-2 py-1 rounded-full text-xs font-semibold shadow-lg">
            {{ i18n "project.featured" | default "Featured" }}
          </div>
        {{ end }}
      </div>

      <!-- 项目内容区域 - 底部 -->
      <div class="flex flex-col">
        <!-- 项目标题 - 单行截断 -->
        <h3 class="text-foreground group-hover:text-primary mb-2 text-base font-semibold leading-tight transition-colors duration-200 truncate">
          {{ $page.Title }}
        </h3>

        <!-- 项目摘要 - 单行显示 -->
        {{ if $summaryContent }}
          <p class="text-muted-foreground text-sm leading-relaxed truncate">
            {{ $summaryContent }}
          </p>
        {{ end }}
      </div>
    </div>
  </a>
</article>

