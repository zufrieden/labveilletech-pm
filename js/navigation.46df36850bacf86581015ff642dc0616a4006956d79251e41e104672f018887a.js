(()=>{var a=class{constructor(){this.elements={},this.gumshoe=null,this.gumshoeToc=null,this.isVisible=!1,this.currentTab="toc",this.init()}init(){this.cacheElements(),this.bindEvents(),this.initGumshoe(),this.exposeAPI(),this.handleResize()}cacheElements(){this.elements={card:document.getElementById("navigation-card"),overlay:document.getElementById("navigation-overlay"),closeBtn:document.getElementById("navigation-close"),tocContent:document.getElementById("nav-content-toc"),seriesContent:document.getElementById("nav-content-series"),tocTab:document.getElementById("nav-tab-toc"),seriesTab:document.getElementById("nav-tab-series"),tocSidebar:document.getElementById("toc-sidebar"),seriesSidebar:document.getElementById("series-sidebar")}}bindEvents(){let{closeBtn:e,overlay:t,tocContent:s,seriesContent:i,tocTab:n,seriesTab:d}=this.elements;e?.addEventListener("click",()=>this.hide()),t?.addEventListener("click",()=>this.hide()),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.isVisible&&this.hide()}),n?.addEventListener("click",()=>this.switchTab("toc")),d?.addEventListener("click",()=>this.switchTab("series")),s?.addEventListener("click",o=>{let r=o.target.closest('a[href^="#"]');r&&(o.preventDefault(),this.scrollToTarget(r.hash))}),i?.addEventListener("click",o=>{o.target.closest("a")&&setTimeout(()=>this.hide(),100)})}switchTab(e){let{tocContent:t,seriesContent:s,tocTab:i,seriesTab:n}=this.elements;this.currentTab=e,e==="toc"?(t?.classList.remove("hidden"),t?.classList.add("block"),s?.classList.add("hidden"),s?.classList.remove("block"),i?.classList.add("border-primary","text-primary"),i?.classList.remove("border-transparent","text-muted-foreground"),i?.setAttribute("aria-selected","true"),n?.classList.remove("border-primary","text-primary"),n?.classList.add("border-transparent","text-muted-foreground"),n?.setAttribute("aria-selected","false")):(s?.classList.remove("hidden"),s?.classList.add("block"),t?.classList.add("hidden"),t?.classList.remove("block"),n?.classList.add("border-primary","text-primary"),n?.classList.remove("border-transparent","text-muted-foreground"),n?.setAttribute("aria-selected","true"),i?.classList.remove("border-primary","text-primary"),i?.classList.add("border-transparent","text-muted-foreground"),i?.setAttribute("aria-selected","false"))}scrollToTarget(e){let t=this.decodeHash(e),s=document.getElementById(t);s&&(s.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>this.hide(),300))}decodeHash(e){try{return decodeURIComponent(e.substring(1))}catch{return console.warn("Hash \u89E3\u7801\u5931\u8D25:",e),e.substring(1)}}initGumshoe(){if(typeof Gumshoe>"u"){console.warn("Gumshoe \u5E93\u672A\u52A0\u8F7D");return}document.querySelectorAll("#nav-content-toc a").length>0&&(this.gumshoeToc=new Gumshoe("#nav-content-toc a",{offset:()=>window.innerHeight*.2,reflow:!0,nested:!0,nestedClass:"active-parent",navClass:"active",contentClass:"active",events:!0})),document.querySelectorAll("#toc-sidebar-content a").length>0&&(this.gumshoe=new Gumshoe("#toc-sidebar-content a",{offset:()=>window.innerHeight*.2,reflow:!0,nested:!0,nestedClass:"active-parent",navClass:"active",contentClass:"active",events:!0}))}show(){!this.elements.card||this.isVisible||(this.isVisible=!0,this.toggleElements(!0),document.body.style.overflow="hidden")}hide(){!this.elements.card||!this.isVisible||(this.isVisible=!1,this.toggleElements(!1),document.body.style.overflow="")}toggle(){this.isVisible?this.hide():this.show()}toggleElements(e){let{card:t,overlay:s}=this.elements;e?(s?.classList.remove("opacity-0","pointer-events-none"),s?.classList.add("opacity-100"),t?.classList.remove("opacity-0","scale-95","pointer-events-none"),t?.classList.add("opacity-100","scale-100")):(s?.classList.add("opacity-0","pointer-events-none"),s?.classList.remove("opacity-100"),t?.classList.add("opacity-0","scale-95","pointer-events-none"),t?.classList.remove("opacity-100","scale-100"))}handleResize(){let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{window.innerWidth>=1280&&this.isVisible&&this.hide()},200)})}exposeAPI(){window.Navigation={show:()=>this.show(),hide:()=>this.hide(),toggle:()=>this.toggle(),switchTab:e=>this.switchTab(e),isVisible:()=>this.isVisible,currentTab:()=>this.currentTab,initialized:!0}}cleanup(){this.gumshoe?.destroy(),this.gumshoeToc?.destroy(),this.gumshoe=null,this.gumshoeToc=null}destroy(){this.cleanup(),document.body.style.overflow=""}},c=null;function l(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{c=new a}):setTimeout(()=>{c=new a},50)}window.addEventListener("beforeunload",()=>{c?.destroy()});l();})();
